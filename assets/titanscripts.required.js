var JSDEBUG=false;var NWS=NWS||(function(){return{initNamespace:function(namespace,initFunction){if(typeof initFunction==='undefined'){console.warn("Must be a function expression who's return value defines the namespace");return}var thisObj=this,names=namespace.split(".");for(var n=names[0]==="NWS"?1:0;n<names.length;n++){thisObj[names[n]]=thisObj[names[n]]||(n===names.length-1?initFunction():{});thisObj=thisObj[names[n]]}const namespaceCreatedEvent=new CustomEvent("NamespaceCreated",{detail:namespace});window.dispatchEvent(namespaceCreatedEvent);return thisObj}}})();NWS.initNamespace("NWS.Block",function(){var _={};return{CallInit:function(initFunc,initArgs){let func=NWS.Modules.Parse(initFunc,window,"function");if(!func){setTimeout(NWS.Block.CallInit,100,initFunc,initArgs);return}func.apply(window,initArgs)},UI:{Tabs:{ShowTab:function(ctl,blockID){var tabUL=ctl.parentNode,tabLIs=tabUL.getElementsByTagName("LI"),container=tabUL.parentNode,selectedDiv=container.querySelector("div#"+ctl.id+"_Content"),tabDivs=container.querySelector("div#TabsContent_"+blockID).getElementsByTagName("DIV");for(var ii=0;ii<tabLIs.length;++ii)tabLIs[ii].classList.remove("selected");for(var jj=0;jj<tabDivs.length;++jj)tabDivs[jj].classList.remove("selected");ctl.classList.add("selected");selectedDiv.classList.add("selected")}}}}});NWS.initNamespace("NWS.Util",function(){var _={getBaseID:function(id){if(id.lastIndexOf("_")===-1)return id;return id.substring(0,id.lastIndexOf("_"))},get:function(id){return document.getElementById(id)},getSet:function(name){return document.getElementsByName(name)},getBaseNode:function(ctl){return _.getClosest(ctl,".Field")},getClosest:function(ctl,selector){if(ctl===null||selector===null)return null;if(!Element.prototype.matches)Element.prototype.matches=Element.prototype.msMatchesSelector;if(!Element.prototype.closest)Element.prototype.closest=function(s){var el=this;do{if(el.matches(s))return el;el=el.parentElement||el.parentNode}while(el!==null&&el.nodeType===1);return null};return ctl.closest(selector)},queryGet:function(selector,target){target=target||document;return target.querySelector(selector)},queryGetAll:function(selector,target){target=target||document;return target.querySelectorAll(selector)}};function Notifier(eventName){this.EventName=eventName;this.Callbacks=[]}Notifier.prototype.Notify=function(target){this.Callbacks.forEach(function(c){var func=c.func,args=c.args.slice(0);args.push(target);func.apply(window,args)})};Notifier.prototype.Subscribe=function(who,callback,callbackArgs){if(this.Callbacks.filter(function(c){return c.who===who}).length>0)return;callbackArgs=callbackArgs||[];this.Callbacks.push({who:who,func:callback,args:callbackArgs})};Notifier.prototype.Unsubscribe=function(who){this.Callbacks=this.Callbacks.filter(function(c){return c.who!==who})};return{Get:function(id){return _.get(id)},GetBaseID:function(id){return _.getBaseID(id)},GetBaseNodeForCtl:function(element){return _.getBaseNode(element)},GetBaseNodeForID:function(id){var element=_.get(id)||_.getSet(id);return _.getBaseNode(element)},GetClosest:function(element,selector){return _.getClosest(element,selector)},GetSet:function(name){return[].slice.call(_.getSet(name))},QueryGet:function(selector,target){return _.queryGet(selector,target)},QueryGetAll:function(selector,target){return[].slice.call(_.queryGetAll(selector,target))},Remove:function(element){if(element&&element.parentNode)element.parentNode.removeChild(element)},ReplaceHtml:function(element,newHtml){if(!element||newHtml===null)return;while(element.lastChild)element.removeChild(element.lastChild);if(newHtml)element.insertAdjacentHTML("afterbegin",newHtml)},ScrollTo:function(element,options){options=options||{behavior:"smooth",block:"end",inline:"nearest"};element.scrollIntoView(options)},Date:{Now:function(){return(new Date).toLocaleString('en-us').replace(/,/gi,"")}},Event:{Cancel:function(evt,doPrevent){if(!(evt instanceof Event))return;evt.stopPropagation();if(doPrevent)evt.preventDefault()},Debounce:function(delay,func,extraEvtArgs,ignore){extraEvtArgs=extraEvtArgs||{};ignore=ignore||[];var timer;return function(e){if(timer)clearTimeout(timer);timer=setTimeout(function(){e.Args=extraEvtArgs;func(e);timer=null},e.key&&ignore.indexOf(e.key)!==-1?0:delay)}},DoMouseEvent:function(ctl,eventType){var evt=typeof Event==='function'?new MouseEvent(eventType,{target:ctl,bubbles:true,cancelable:true}):null;if(evt===null){evt=document.createEvent('MouseEvent');evt.initEvent(eventType,true,true);evt.target=ctl}ctl.dispatchEvent(evt)},DoEvent:function(ctl,eventType){var evt=typeof Event==='function'?new Event(eventType,{target:ctl,bubbles:true,cancelable:true}):null;if(evt===null){evt=document.createEvent('Event');evt.initEvent(eventType,true,true);evt.target=ctl}if(ctl instanceof NodeList&&ctl.length>0)ctl[0].dispatchEvent(evt);else if(Array.isArray(ctl)&&ctl.length>0)ctl[0].dispatchEvent(evt);else ctl.dispatchEvent(evt)},DoHandlerForKeypress:function(evt,key,handler){var evtKey=NWS.Util.KeyValue[evt.key]||evt.key;if(!evtKey)return;if(evtKey!==key)return;NWS.Util.Event.Cancel(evt,key===NWS.Util.KeyValue.Enter);return handler.apply(window,[evt])}},Notifier:Notifier,KeyValue:{Win:"Meta",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Enter:"Enter",Tab:"Tab",Meta:"Meta",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",Delete:"Delete",ContextMenu:"ContextMenu",Escape:"Escape",Insert:"Insert","":""},Print:{PrintPage:function(printPageString){if(printPageString&&printPageString.length&&printPageString[printPageString.length-1]!=="&")printPageString+="&";var params=NWS.Util.Print.FormatParams();if(typeof params==="undefined"){setTimeout(NWS.Util.Print.PrintPage,100,printPageString);return}window.open(window.location.protocol+"//"+window.location.host+window.location.pathname+printPageString+params)},Email:function(subjectLine){var params=NWS.Util.Print.FormatParams();if(typeof params==="undefined"){setTimeout(NWS.Util.Print.Email,100,subjectLine);return}window.open("mailto:?subject="+encodeURIComponent(subjectLine)+"&body="+encodeURIComponent(window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+params),"_self")},FormatParams:function(){if(!NWS.Block.Aggregation){NWS.Modules.LoadResources(["/Views/Display/Blocks/AggregationV2/AggregationV2Display.js"],[{func:"NWS.Util.UI.FormatParams"}]);return}return NWS.Block.Aggregation.BuildFullQueryString(-1)}},UI:{DefaultButton:function(evt,btn){if(!btn)return;NWS.Util.Event.DoHandlerForKeypress(evt,NWS.Util.KeyValue.Enter,function(e){NWS.Util.Event.DoMouseEvent(btn,"click")})},SearchSubmit:function(baseURL,searchCtl){searchCtl.classList.remove("error");if(searchCtl.value.trim()===""){searchCtl.classList.add("error");return}location.href=baseURL.indexOf("?")>0?baseURL+"&Search_Keywords="+encodeURIComponent(searchCtl.value):baseURL+"?Search_Keywords="+encodeURIComponent(searchCtl.value)},GoBack:function(evt){NWS.Util.Event.Cancel(evt,true);history.back();return false},FreeformPreviewTidy:function(data){var retVal=data,tidySteps=[{Pattern:new RegExp("on(click|keyup|change|focus|blur)\\s*=\\s*'[^']*?'","gi"),Replacement:"on$1='javascript:window.console.log(&quot;on$1 action disabled in preview.&quot;);return false;'"},{Pattern:new RegExp("on(click|keyup|change|focus|blur)\\s*=\\s*\"[^\"]*?\"","gi"),Replacement:"on$1='javascript:window.console.log(&quot;on$1 action disabled in preview.&quot;);return false;'"},{Pattern:new RegExp("href\\s*=\\s*'[^']*?'","gi"),Replacement:"href='#' onclick='javascript:window.console.log(&quot;Links are not available in this view.&quot;);return false;'"},{Pattern:new RegExp("href\\s*=\\s*\"[^\"]*?\"","gi"),Replacement:"href='#' onclick='javascript:window.console.log(&quot;Links are not available in this view.&quot;);return false;'"}];tidySteps.filter(step=>step.Pattern.test(retVal)).forEach(step=>retVal=retVal.replace(step.Pattern,step.Replacement));return retVal},FollowPreviewLink:function(link,evt){NWS.Util.Event.Cancel(evt,true);if(link.getAttribute("alert")==="true"){window.alert("Links are not available in this view");return}var qs=location.hash||location.search,orig=link.getAttribute("originalHref"),dest=(/^[a-z][a-z0-9+-.]+:\/\//gi).test(orig)||link.getAttribute("linkType")==="5"||link.getAttribute("linkType")==="9"?orig:"/LinkPreview?PreviewUrl="+encodeURIComponent(orig);if(qs!==""){var qvars=qs.substring(1).split("&"),newQS="";if(qvars.length>0){for(var i=0;i<qvars.length;i++)if(qvars[i].substr(0,5)!=="DocID")newQS+=newQS===""?"?"+qvars[i]:"&"+qvars[i]}dest+=encodeURIComponent(newQS)}if(link.getAttribute("target")==="_blank"){window.open(dest);return}window.location.href=dest}}}});NWS.initNamespace("NWS.Logging",function(){var _={IsDebug:function(){return typeof JSDEBUG!=="undefined"&&JSDEBUG}};return{Log:function(msg){_.IsDebug()&&console.log(msg)},Warn:function(msg){_.IsDebug()&&console.warn(msg)},Track:function(data){window.dataLayer=window.dataLayer||[];window.dataLayer.push(data)}}});NWS.initNamespace("NWS.Bundling",function(){const _absUrlRegEx=/^https?:\/\/|^\/\//i;const DEFAULT_EXT_CONFIG=[new ExtConfig("script","src",[{name:"language",value:"javascript"},{name:"type",value:"text/javascript"}],[".js"]),new ExtConfig("link","href",[{name:"rel",value:"stylesheet"},{name:"type",value:"text/css"}],[".css"])];const PRELOAD_EXT_CONFIG=[new ExtConfig("link","href",[{name:"rel",value:"preload"},{name:"as",value:"script"}],[".js"]),new ExtConfig("link","href",[{name:"rel",value:"preload"},{name:"as",value:"style"}],[".css"])];var _={ProcessNewElement:function(url,parentSelector,config,callbacks){if(_.Exists(url,config))return;parentSelector=parentSelector||"html head";var parent=document.querySelector(parentSelector);if(!parent)return;var newElement=document.createElement(config.TagName);newElement.setAttribute(config.UrlAttribute,url);config.StaticAttributes.forEach(function(attr){newElement.setAttribute(attr.name,attr.value)});callbacks.reduce(function(newCallbacks,callbackOrCallbackArray){return newCallbacks.concat(callbackOrCallbackArray)},[]).forEach(function(callback){callback.ListenTo(newElement)});NWS.Logging.Log("Pushing url to callstack: "+url);parent.appendChild(newElement)},Exists:function(url,config){var loaded=[].slice.call(document.querySelectorAll(config.TagName)).filter(function(el){return el.hasAttribute(config.UrlAttribute)&&el.getAttribute(config.UrlAttribute).toLowerCase()===url.toLowerCase()});if(loaded.length===0)return false;if(loaded.filter(function(el){return config.StaticAttributes.filter(function(attr){return el.getAttribute(attr.name)===attr.value})[0]}).length>0){NWS.Logging.Warn("Duplicate resource called: "+url+".  It will not be loaded again.");return true}return false},Remove:function(url,config){if(!_.Exists(url,config))return;var loaded=[].slice.call(document.querySelectorAll(config.TagName)).filter(function(el){return el.hasAttribute(config.UrlAttribute)&&el.getAttribute(config.UrlAttribute).toLowerCase()===url.toLowerCase()}).filter(function(el){return config.StaticAttributes.filter(function(attr){return el.getAttribute(attr.name)===attr.value})[0]});loaded.forEach(function(el){el.remove()})},GetExtensionConfig:function(config,ext){var extConfig=null,extFilter=function(c){return c.Extensions.indexOf(ext)>-1};if(config instanceof ExtConfig)extConfig=config.filter(extFilter);if(!extConfig||extConfig.length===0){if(typeof config==="string"&&config==="preload")config=PRELOAD_EXT_CONFIG;else config=DEFAULT_EXT_CONFIG;extConfig=config.filter(extFilter)}if(extConfig.length>1)NWS.Logging.Warn("Only one configuration per extension is supported.  Only the first configuration provided will be used.");return extConfig[0]}};function ExtConfig(tagName,urlAttributeName,attributes,extensions){this.TagName=tagName;this.UrlAttribute=urlAttributeName;this.StaticAttributes=attributes;this.Extensions=extensions}function Resource(url,callback){this.Url=url;this.Callbacks=[callback||new Callback]}Resource.prototype.GetExtension=function(){var url=this.Url;var qsIdx=url.indexOf("?");if(qsIdx>0)url=url.substring(0,qsIdx);return url.substring(url.lastIndexOf("."))};Resource.prototype.IsAbsolute=function(){return _absUrlRegEx.test(this.Url)};Resource.prototype.Exists=function(config){var extFilter=function(c){return c.Extensions.indexOf(this.GetExtension())>-1}.bind(this);config=config||DEFAULT_EXT_CONFIG.filter(extFilter)[0];return _.Exists(this.Url,config)};Resource.prototype.Load=function(config,parentSelector){config=_.GetExtensionConfig(config,this.GetExtension());_.ProcessNewElement(this.Url,parentSelector,config,this.Callbacks)};Resource.prototype.Remove=function(config){config=_.GetExtensionConfig(config,this.GetExtension());_.Remove(this.Url,config)};function Callback(onSuccess,onError,onComplete){this.Success=onSuccess||null;this.Error=onError||null;this.Complete=onComplete||null;this.Status="waiting"}Callback.prototype.ListenTo=function(element){if(!(element instanceof Element))return;var func=function(evt){var type=evt.type,thisCallback=this,resource=evt.target.getAttribute("src")||evt.target.getAttribute("href");thisCallback.Status="complete";NWS.Logging.Log("Following resource returned:"+resource);switch(type){case"error":if(thisCallback.Error){NWS.Logging.Log("Calling load error method for "+resource);thisCallback.Error(evt)}break;default:if(thisCallback.Success){NWS.Logging.Log("Calling load success method for "+resource);thisCallback.Success(evt)}break}if(thisCallback.Complete){NWS.Logging.Log("Calling load complete method for "+resource);thisCallback.Complete(evt)}NWS.Logging.Log("Callback complete for "+resource)};element.addEventListener("load",func.bind(this),false);element.addEventListener("error",func.bind(this),false)};function Bundle(fileExtension,config){if(fileExtension==="")throw"No file extension provided";fileExtension=fileExtension.indexOf(".")===0?fileExtension:"."+fileExtension;this.Extension=fileExtension;this.ExtensionConfig=null;this.Resources=[];this.Status="waiting";this.ExtensionConfig=_.GetExtensionConfig(config,fileExtension)}Bundle.prototype.AddResource=function(resource){if(!(resource instanceof Resource))throw"Invalid resource";var existingResource=this.Resources.filter(function(existingResource){return existingResource.Url===resource.Url})[0];if(!existingResource)this.Resources.push(resource);else existingResource.Callbacks=existingResource.Callbacks.concat(resource.Callbacks)};Bundle.prototype.GetBundleUrl=function(){var relativeUrls=this.Resources.filter(function(resource){return!resource.IsAbsolute()}).map(function(resource){return encodeURIComponent(resource.Url)});return relativeUrls.length?["/_bundle",this.Extension,"?file=",relativeUrls.join("&file=")].join(""):""};Bundle.prototype.GetBundleCallbacks=function(){return this.Resources.filter(function(resource){return!resource.IsAbsolute()}).map(function(resource){return resource.Callbacks})};Bundle.prototype.GetAbsoluteUrls=function(){return this.Resources.filter(function(resource){return resource.IsAbsolute()}).map(function(resource){return resource.Url})};Bundle.prototype.Load=function(contentLoadedCallback,parentSelector){if(this.Status!=="waiting"){NWS.Logging.Warn("Bundle is already loaded");return}var bundleCompleteCallback=function(){var stillWaiting=this.Resources.map(function(resource){return resource.Callbacks}).reduce(function(newCallbacks,callbackOrCallbackArray){return newCallbacks.concat(callbackOrCallbackArray)},[]).filter(function(callback){return callback.Status==="waiting"}).length>0;if(!stillWaiting){this.Status="complete";var func=function(){if(typeof contentLoadedCallback==="function"&&contentLoadedCallback)contentLoadedCallback()};if(document.readyState==="complete"||document.readyState==="loaded"||document.readyState==="interactive")func();else document.addEventListener("DOMContentLoaded",func,false)}}.bind(this);var bundleUrl=this.GetBundleUrl();var bundleCallbacks=this.GetBundleCallbacks();if(bundleUrl.length>0){bundleCallbacks.push(new Callback(null,null,bundleCompleteCallback));_.ProcessNewElement(bundleUrl,parentSelector,this.ExtensionConfig,bundleCallbacks)}this.Resources.filter(function(resource){return resource.IsAbsolute()}).forEach(function(externalResource){externalResource.Callbacks.push(new Callback(null,null,bundleCompleteCallback));_.ProcessNewElement(externalResource.Url,parentSelector,this.ExtensionConfig,externalResource.Callbacks)}.bind(this))};return{Callback:Callback,Bundle:Bundle,ExtConfig:ExtConfig,Resource:Resource}});NWS.initNamespace("NWS.Modules",function(){var _manager={requests:[],ready:[],running:false,isNotReady:function(resource){var url=resource instanceof NWS.Bundling.Resource?resource.Url:resource;return _manager.ready.indexOf(url)===-1},isNotFinished:function(request){return!request.finished},onResourceReady:function(evt){var url=evt.target.getAttribute("src")||evt.target.getAttribute("href");if(_manager.ready.indexOf(url)===-1)_manager.ready.push(url);var finalize=[];_manager.requests.forEach(function(request,idx){request.resources=request.resources.filter(_manager.isNotReady);if(request.resources.length===0&&!request.finished)finalize.push(idx)});finalize.forEach(function(idx){_manager.doInitList(_manager.requests[idx].initList);_manager.requests[idx].finished=true});_manager.requests=_manager.requests.filter(_manager.isNotFinished);_manager.process()},process:function(){if(_manager.requests.length===0){_manager.running=false;return}var next=null;for(var i=0;i<_manager.requests.length;i++){if(_manager.requests[i].finished||_manager.requests[i].resources.length===0)continue;for(var j=0;j<_manager.requests[i].resources.length;j++){if(!_manager.isNotReady(_manager.requests[i].resources[j])||_manager.requests[i].resources[j].Exists())continue;next=_manager.requests[i].resources[j];break}if(next!==null)break}if(next!==null)next.Load()},doInitList:function(initList){initList.forEach(function(init){NWS.Modules.ExecuteFunctionByName(init.func,window,init.args)})}};var _={ProcessResources:function(resourceUrls,initList){var notReady=resourceUrls.filter(_manager.isNotReady);if(notReady.length===0){_manager.doInitList(initList);return}_manager.requests.push({resources:notReady.map(function(url){return new NWS.Bundling.Resource(url,new NWS.Bundling.Callback(null,null,_manager.onResourceReady))}),initList:initList,finished:false});if(!_manager.running){_manager.running=true;_manager.process()}},initializedModules:[],moduleInitialized:function(moduleNamespaceToInitialize){if(_.initializedModules.indexOf(moduleNamespaceToInitialize)===-1){_.initializedModules.push(moduleNamespaceToInitialize);return false}return true}};return{LoadResources:function(resourcePaths,initList){if(!Array.isArray(resourcePaths)){NWS.Logging.Warn("Must provide an array of resource paths");return}_.ProcessResources(resourcePaths.reverse(),initList||[])},ExecuteFunctionByName:function(funcName,context,args){var func=NWS.Modules.Parse(funcName,context,"function");if(func!==null){var argsArray=Array.isArray(args)?args:[args];try{return func.apply(this,argsArray)}catch(e){console.log(e.message)}}},Parse:function(name,context,type){context=context||window;var namespaces=name.split("."),func=namespaces.pop();for(var ii=0;ii<namespaces.length;ii++){context=context[namespaces[ii]];if(!context)return null}return context[func]&&typeof context[func]===type?context[func]:null},Register:function(resourceUrls,contentLoadedCallback,extConfigsOverride){if(!Array.isArray(resourceUrls)){alert("Must provide an array of module resource urls");return}var extensions=[],bundles=[];resourceUrls.forEach(function(url){var resource=url instanceof NWS.Bundling.Resource?url:new NWS.Bundling.Resource(url),ext=resource.GetExtension(),idx=extensions.indexOf(ext);if(idx===-1){idx=extensions.length;extensions.push(ext);bundles.push(new NWS.Bundling.Bundle(ext,extConfigsOverride))}bundles[idx].AddResource(resource)});var bundlesLoadedCallback=function(){var stillWaiting=bundles.filter(function(bundle){return bundle.Status==="waiting"}).length>0;if(!stillWaiting){var func=function(){if(typeof contentLoadedCallback==="function"&&contentLoadedCallback)contentLoadedCallback()};if(document.readyState==="complete"||document.readyState==="loaded"||document.readyState==="interactive")func();else document.addEventListener("DOMContentLoaded",func,false)}};bundles.forEach(function(bundle){return bundle.Load(bundlesLoadedCallback)})},InitModule:function(moduleNamespace,params){var namespaceCreatedCallback=function(evt){if(evt.detail===moduleNamespace&&!_.moduleInitialized(moduleNamespace)){var initFunc=NWS.Modules.Parse([moduleNamespace,".init"].join(""),window,"function");initFunc(typeof params==="object"?params:{})}};var moduleInitFunc=NWS.Modules.Parse([moduleNamespace,".init"].join(""),window,"function");if(!moduleInitFunc){window.addEventListener("NamespaceCreated",namespaceCreatedCallback,false);return}if(!_.moduleInitialized(moduleNamespace))moduleInitFunc(typeof params==="object"?params:{})}}});NWS.initNamespace("NWS.Xml",function(){function processAttributes(attributes){var node=NWS.Xml.Parse("<T/>"),element=node.querySelector(":root");if(attributes&&Array.isArray(attributes))attributes.filter(function(a){return typeof a.name!==undefined&&typeof a.value!==undefined}).forEach(function(a){element.setAttribute(a.name,a.value)});return NWS.Xml.ToString(node).slice(2,-2)}return{MakeTag:function(tagName,data,attributes,doCData){if(data===null&&attributes===null)return"";if(data===null&&!doCData)return["<",tagName,processAttributes(attributes),"/>"].join("");return[NWS.Xml.MakeStartTag(tagName,attributes,doCData),data,NWS.Xml.MakeEndTag(tagName,doCData)].join("")},MakeStartTag:function(tagName,attributes=null,doCData=false){if(!tagName||tagName.length===0)return"";return["<",tagName,processAttributes(attributes),">",doCData?"<![CDATA[":""].join("")},MakeEndTag:function(tagName,doCData=false){if(!tagName||tagName.length===0)return"";return[doCData?"]]>":"","</",tagName,">"].join("")},Parse:function(xmlString){try{var parser=new DOMParser,xml=parser.parseFromString(xmlString,"application/xml"),errors=xml.querySelectorAll("parsererror");if(errors.length!==0)return null;return xml}catch(ex){return null}},ToString:function(xml){var serializer=new XMLSerializer;return serializer.serializeToString(xml)}}})